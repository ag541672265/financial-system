!function(win,doc){var __cookie,URL_PERFORMANCD="//web.huizecdn.com/img/performance.png",status=!0,MyEvent={init:function(){window.addEventListener?(MyEvent.on=function(e,t,n){e.addEventListener(t,n,!1)},MyEvent.off=function(e,t,n){e.removeEventListener(t,n,!1)}):window.attachEvent?(MyEvent.on=function(e,t,n){e.attachEvent("on"+t,n)},MyEvent.off=function(e,t,n){e.detachEvent("on"+t,n)}):(MyEvent.on=function(e,t,n){e["on"+t]=n},MyEvent.off=function(e,t){e["on"+t]=null})}};function Ajax(e){var t,n,o,r=this;for(t in this.ops=e||{},this.url=this.ops.url,this.type=this.ops.type||"get",this.dataType=this.ops.dataType||"json",this.data=this.ops.data||null,this.headers=this.ops.headers||{},this.success=this.ops.success||function(){},this.xml=new XMLHttpRequest,this.xml.open(this.type,this.url),this.xml.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.headers)this.xml.setRequestHeader(t,this.headers[t]);for(o in this.xml.onreadystatechange=function(e){r.onreadystatechange(e)},n=[],this.data)n.push(o+"="+this.data[o]);this.xml.send(n.join("&"))}function __ajax(e){return new Ajax(e)}function getPerformanceTiming(){var e=window.performance||window.webkitPerformance||window.msPerformance,t=e.timing,n={};if(e)return n.loadPage=t.loadEventEnd-t.navigationStart,n.domReady=t.domComplete-t.responseEnd,n.redirect=t.redirectEnd-t.redirectStart,n.lookupDomain=t.domainLookupEnd-t.domainLookupStart,n.ttfb=t.responseStart-t.navigationStart,n.request=t.responseEnd-t.requestStart,n.loadEvent=t.loadEventEnd-t.loadEventStart,n.appcache=t.domainLookupStart-t.fetchStart,n.unloadEvent=t.unloadEventEnd-t.unloadEventStart,n.connect=t.connectEnd-t.connectStart,n;console.log("你的浏览器不支持 performance 接口")}function run(){var e=[],t=new Image;e.push("t="+(new Date).getTime()),e.push("pf="+encodeURIComponent(JSON.stringify(getPerformanceTiming()))),e.push("url="+encodeURIComponent(location.href)),e.push("ua="+encodeURIComponent(navigator.userAgent)),t.onload=t.onerror=function(){t=null},t.src=URL_PERFORMANCD+"?"+e.join("&")}function log(){try{console.warn.apply(this,arguments)}catch(e){}}MyEvent.init(),Ajax.prototype={constructor:Ajax,onreadystatechange:function(ev){var _this=this,currentTarget=ev.currentTarget||{},result=currentTarget.responseText;if(4===currentTarget.readyState&&(200===currentTarget.status||304===currentTarget.status)){if("json"===_this.dataType)try{result=JSON.parse(currentTarget.responseText)}catch(error){try{result=eval("("+result+")")}catch(e){}}_this.success(result)}}},__cookie={set:function(e,t,n,o,r,a){var s,i,c,u,d,p,l,h;return"object"==typeof arguments[0]?(i=arguments[0].name,c=arguments[0].value,u=arguments[0].expires,d=arguments[0].path,p=arguments[0].domain,l=arguments[0].secure):(i=e,c=t,u=n,d=o,p=r,l=a),s=i+"="+encodeURIComponent(c),u&&((h=new Date).setTime(h.getTime()+60*n*60*1e3),s+="; expires="+h.toUTCString()),d&&(s+="; path="+d),p&&(s+="; domain="+p),l&&(s+="; secure"+l),doc.cookie=s,c},get:function(e){var t=null;return new RegExp("(?:; )?"+e+"=([^;]*)").test(doc.cookie)&&(t=decodeURIComponent(RegExp.$1)),t},remove:function(e,t,n){var o,r,a;return"object"==typeof arguments[0]?(o=arguments[0].name,r=arguments[0].path,a=arguments[0].domain):(o=e,r=t,a=n),this.set(o,"",new Date(0),r,a),o},clearAll:function(){var e,t,n,o,r=doc.cookie.split(";"),a=r.length;for(e=0;e<a;e++)o=(o=(n=(t=r[e]).indexOf("="))>-1?t.substr(0,n):t).replace(/^\s*|\s*$/,""),doc.cookie=o+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}},setTimeout(function(){status&&(status=!1,run())},3e3),MyEvent.on(window,"load",function(){status&&setTimeout(run,2e3),status=!1});var type={"-1":"未知错误",0:"脚本错误",1:"业务错误",2:"网络问题",3:"其他"};function JSTracker(e){var t={dev:!1};for(var n in e)t[n]=e[n];log(t),log("type 为1，脚本错误，为2业务错误，为3，未知错误,4:网络异常")}JSTracker.prototype={constructor:JSTracker,__send:function(e){var t=new Image;t.onload=t.onerror=function(){t=null},t.src="//web.huizecdn.com/img/tracker.png?params="+encodeURIComponent(e)},add:function(e){var t={};return t.type=e.type,t.message=e.message,t.source=e.source,t.v=(new Date).getTime(),t.ua=navigator.userAgent,t.url=location.href,void 0===t.type?(console.log(type),console.log("type不能为空")):void 0===t.message?console.log("message不能为空"):void this.__send(JSON.stringify(t))}},win.__Ajax=Ajax,win.__cookie=__cookie,win.__ajax=__ajax,win.jsTracker=new JSTracker}(window,document);