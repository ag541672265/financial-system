define(["jquery","underscore","exports","require","module","helper","layer"],function($,n,e,t,r,o,i){"use strict";var u=function(){u.prototype.init.apply(this,arguments)},a="https://passport.huize.com";u.prototype={personInfo:{},init:function(){var r=this;r.initActions(),t(["require-text!/html/public/top-menu.html"],function(t){o.request.getJson({url:"/api/v2/users/profile"},function(e){window.__profile=(e||{}).data,(e=e.result||{}).id=e.id||"",e.quitUrl="/api/v2/users/logout?returnurl="+encodeURI(location.href),e.SignInUrl=a+e.SignInUrl+"?returnurl="+encodeURI(location.href),e.RegisterUrl=a+e.RegisterUrl+"?returnurl="+encodeURI(location.href),$(".top-nav-wrap .top-nav-menu").prepend($(n.template(t)(e))),r.initActions(),"0"!==e.CustomerCode&&(window.hzins={},window.hzins.login=!0)})})},initActions:function(){var i=this;$("#myinfo, #mainMenu").delegate("li","mouseover",function(){$(".drop-menu-item-body",this).removeClass("fn-hide"),$(this).addClass("top-nav-menu-item-hover")}),$("#myinfo, #mainMenu").delegate("li","mouseleave",function(){$(".drop-menu-item-body",this).addClass("fn-hide"),$(this).removeClass("top-nav-menu-item-hover")}),$("#btnSearchProduct").click(function(e){e.preventDefault();var t=$("#txtSearchProduct").val(),r=$("#txtSearchProduct").attr("placeholder-text"),n=i.filterKeyWords(t);if(""===n&&"请输入关键字"!==r&&(n=i.filterKeyWords(r)),""!==n){var o="//search.huize.com/p-1-"+encodeURI(n)+"-0-0-1";location.href=o}}),$("#txtSearchProduct").keydown(function(e){var t=e||window.event;return 13!=(t.keyCode||t.which||t.charCode)||($("#btnSearchProduct").click(),!1)})},filterKeyWords:function(e){var t=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩ]");e=e.replace(/<[^>]+>/g,"").replace(/[\~\`\!\@\#\$\%\^\&\*\{\}\,\-\_\]\[\+\:\;\"\'\=\|\\\<\>\?\/\.\(\)]/g,"").replace(/^\s*/,"").replace(/\s*$/,"");for(var r="",n=0;n<e.length;n++)r+=e.substr(n,1).replace(t,"");return r}},r.exports=u});