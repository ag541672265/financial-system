define(["jquery","underscore","layer"],function($,c,o){"use strict";return{sendAjax:function(t,n,e,s,a){var u={async:!0,cache:!1,success:function(t){var n=t.result;if(t.status&&"00000"!=t.status){if("function"==typeof a)return a(n,t.status,t.message);o.msg(t.message)}else"function"==typeof s&&s(n)},error:function(){"function"==typeof a&&a.apply(null,arguments)}};c.extend(u,e),u.type=(t||"POST").toUpperCase(),u.url=n,"POST"!==t&&"PUT"!==t||(u.dataType="json",u.data={data:JSON.stringify(u.data)||"{}"}),$.ajax(u)},update:function(t,n,e,s){this.sendAjax("PUT",t,n,e,s)},save:function(t,n,e,s){this.sendAjax("POST",t,n,e,s)},fetch:function(t,n,e,s){this.sendAjax("GET",t,n,e,s)},destroy:function(t,n,e,s){this.sendAjax("DELETE",t,n,e,s)},jsonp:function(t,n,e){$.ajax({async:!0,url:t,type:"GET",dataType:"jsonp",jsonp:"callback",data:n,success:function(t){"function"==typeof e&&e(t)}})}}});